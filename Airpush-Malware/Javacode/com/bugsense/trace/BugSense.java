package com.bugsense.trace;

import android.app.Notification;
import android.app.NotificationManager;
import android.app.PendingIntent;
import android.content.Context;
import android.content.Intent;
import android.content.res.Resources;
import android.net.Uri;
import android.util.Log;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import org.json.JSONObject;

public class BugSense {
    private static ExecutorService executor = Executors.newFixedThreadPool(2);

    public static ExecutorService getExecutor() {
        if (executor == null) {
            executor = Executors.newFixedThreadPool(2);
        }
        return executor;
    }

    public static void showUpgradeNotification(Context context, String str) {
        if (BugSenseHandler.I_WANT_TO_DEBUG) {
            Log.i(C0069G.TAG, "Show notification: " + str);
        }
        if (str != null && str.length() > 5) {
            try {
                Object obj;
                CharSequence charSequence;
                NotificationManager notificationManager = (NotificationManager) context.getSystemService("notification");
                JSONObject jSONObject = new JSONObject(new JSONObject(str).getString("data"));
                String string = jSONObject.getString("tickerText");
                if (BugSenseHandler.locTicker == null || BugSenseHandler.locTicker.length() <= 1) {
                    obj = string;
                } else {
                    charSequence = BugSenseHandler.locTicker;
                }
                long currentTimeMillis = System.currentTimeMillis();
                Resources resources = context.getResources();
                int identifier = resources.getIdentifier("ic_launcher", "drawable", context.getPackageName());
                if (identifier == 0) {
                    identifier = resources.getIdentifier(IConstants.ICON, "drawable", context.getPackageName());
                }
                Notification notification = new Notification(identifier, charSequence, currentTimeMillis);
                notification.flags = 16;
                string = jSONObject.getString("contentTitle");
                if (BugSenseHandler.locTitle == null || BugSenseHandler.locTitle.length() <= 1) {
                    obj = string;
                } else {
                    charSequence = BugSenseHandler.locTitle;
                }
                CharSequence string2 = jSONObject.getString("contentText");
                if (BugSenseHandler.locText != null && BugSenseHandler.locText.length() > 1) {
                    string2 = BugSenseHandler.locText;
                }
                notification.setLatestEventInfo(context, charSequence, string2, PendingIntent.getActivity(context, 0, new Intent("android.intent.action.VIEW", Uri.parse(jSONObject.getString(IConstants.NOTIFICATION_URL))), 268435456));
                notificationManager.notify(1, notification);
            } catch (Exception e) {
                Log.e(C0069G.TAG, "Error starting fix notification");
                if (BugSenseHandler.I_WANT_TO_DEBUG) {
                    e.printStackTrace();
                }
            }
        }
    }
}
