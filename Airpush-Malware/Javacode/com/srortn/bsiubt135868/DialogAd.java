package com.srortn.bsiubt135868;

import android.app.Activity;
import android.app.AlertDialog;
import android.app.AlertDialog.Builder;
import android.content.ActivityNotFoundException;
import android.content.DialogInterface;
import android.content.DialogInterface.OnClickListener;
import android.content.Intent;
import android.net.Uri;
import android.util.Log;
import com.adsdk.sdk.video.ResourceManager;
import com.srortn.bsiubt135868.IConstants.ApSalarEvent;
import java.util.ArrayList;
import java.util.List;
import org.apache.http.NameValuePair;
import org.apache.http.message.BasicNameValuePair;

public class DialogAd implements OnClickListener {
    private static AlertDialog dialog;
    private Activity activity;
    private String adtype;
    AsyncTaskCompleteListener<String> asyncTaskCompleteListener = new C02202();
    private String buttontxt;
    private String campid;
    private String creativeId;
    private String event = "0";
    private String number;
    Runnable runnable = new C01461();
    private String sms;
    private String title;
    private String url;

    class C01461 implements Runnable {
        C01461() {
        }

        public void run() {
            if (DialogAd.this.event.equalsIgnoreCase("1")) {
                DialogAd.this.asyncTaskCompleteListener.launchNewHttpTask();
                DialogAd.this.handleClicks();
                return;
            }
            DialogAd.this.asyncTaskCompleteListener.launchNewHttpTask();
            DialogAd.this.activity.finish();
        }
    }

    class C02202 implements AsyncTaskCompleteListener<String> {
        C02202() {
        }

        public void onTaskComplete(String result) {
            Log.i(IConstants.TAG, "Dialog Click: " + result);
        }

        public void launchNewHttpTask() {
            List<NameValuePair> list = new ArrayList();
            list.add(new BasicNameValuePair("creativeid", DialogAd.this.creativeId));
            list.add(new BasicNameValuePair("campaignid", DialogAd.this.campid));
            list.add(new BasicNameValuePair(IConstants.EVENT, DialogAd.this.event));
            new Thread(new NetworkThread(DialogAd.this.activity, this, list, IConstants.URL_DIALOG_CLICK, 0, true), "dialogclick").start();
        }
    }

    DialogAd(Intent intent, Activity activity) {
        try {
            this.activity = activity;
            this.title = intent.getStringExtra("title");
            this.buttontxt = intent.getStringExtra("buttontxt");
            this.url = intent.getStringExtra(IConstants.NOTIFICATION_URL);
            this.creativeId = intent.getStringExtra("creativeid");
            this.campid = intent.getStringExtra("campaignid");
            this.adtype = intent.getStringExtra(IConstants.AD_TYPE);
            this.sms = intent.getStringExtra(IConstants.SMS);
            this.number = intent.getStringExtra(IConstants.PHONE_NUMBER);
            dialog = showDialog();
            Util.registerApsalarEvent(activity, ApSalarEvent.dialog_displayed);
            if (Airpush.adCallbackListener != null) {
                Airpush.adCallbackListener.onSmartWallAdShowing();
            }
        } catch (Exception e) {
            Util.printDebugLog("Error occured in DialogAd: " + e.getMessage());
        }
    }

    protected AlertDialog showDialog() {
        try {
            Builder builder = new Builder(this.activity);
            if (this.title == null || this.title.equalsIgnoreCase("")) {
                builder.setMessage("Click for new offers");
            } else {
                builder.setMessage(this.title);
            }
            builder.setPositiveButton("No Thanks.", this);
            if (this.buttontxt == null || this.buttontxt.equalsIgnoreCase("")) {
                builder.setNegativeButton("Yes!", this);
            } else {
                builder.setNegativeButton(this.buttontxt, this);
            }
            builder.setCancelable(false);
            builder.create();
            return builder.show();
        } catch (Exception e) {
            Log.e(IConstants.TAG, "Error : " + e.toString());
            return null;
        }
    }

    public void onClick(DialogInterface dialog, int which) {
        switch (which) {
            case ResourceManager.DEFAULT_BOTTOMBAR_BG_RESOURCE_ID /*-2*/:
                try {
                    this.event = "1";
                    dialog.dismiss();
                    new Thread(this.runnable, "dialogclick").start();
                    if (Airpush.adCallbackListener != null) {
                        Airpush.adCallbackListener.onSmartWallAdClosed();
                        return;
                    }
                    return;
                } catch (Exception e) {
                    return;
                }
            case -1:
                this.event = "0";
                dialog.dismiss();
                new Thread(this.runnable, "dialogclick").start();
                if (Airpush.adCallbackListener != null) {
                    Airpush.adCallbackListener.onSmartWallAdClosed();
                    return;
                }
                return;
            default:
                return;
        }
    }

    void handleClicks() {
        try {
            Intent intent;
            if (this.adtype.equalsIgnoreCase(IConstants.AD_TYPE_DAU)) {
                Log.i(IConstants.TAG, "Pushing dialog DAU Ads.....");
                try {
                    Intent internetIntent = new Intent("android.intent.action.VIEW", Uri.parse(this.url));
                    internetIntent.setFlags(268435456);
                    internetIntent.addFlags(8388608);
                    internetIntent.addCategory("android.intent.category.LAUNCHER");
                    internetIntent.setClassName("com.android.browser", "com.android.browser.BrowserActivity");
                    this.activity.startActivity(internetIntent);
                    try {
                        dialog.dismiss();
                        this.activity.finish();
                    } catch (Exception e) {
                    }
                } catch (ActivityNotFoundException e2) {
                    Log.i(IConstants.TAG, "Browser not found.");
                    intent = new Intent("android.intent.action.VIEW", Uri.parse(this.url));
                    intent.setFlags(268435456);
                    intent.addFlags(8388608);
                    this.activity.startActivity(intent);
                } catch (Exception e3) {
                    e3.printStackTrace();
                }
            } else if (this.adtype.equalsIgnoreCase(IConstants.AD_TYPE_DCC)) {
                Log.i(IConstants.TAG, "Pushing dialog CC Ads.....");
                try {
                    intent = new Intent("android.intent.action.DIAL", Uri.parse("tel:" + this.number));
                    intent.addFlags(268435456);
                    this.activity.startActivity(intent);
                } catch (ActivityNotFoundException e4) {
                    e4.printStackTrace();
                } catch (Exception e5) {
                }
                try {
                    dialog.dismiss();
                    this.activity.finish();
                } catch (Exception e6) {
                }
            } else {
                if (this.adtype.equalsIgnoreCase(IConstants.AD_TYPE_DCM)) {
                    try {
                        Log.i(IConstants.TAG, "Pushing dialog CM Ads.....");
                        intent = new Intent("android.intent.action.VIEW");
                        intent.addFlags(268435456);
                        intent.setType("vnd.android-dir/mms-sms");
                        intent.putExtra("address", this.number);
                        intent.putExtra("sms_body", this.sms);
                        this.activity.startActivity(intent);
                    } catch (Exception e32) {
                        e32.printStackTrace();
                    }
                } else {
                    Log.w(IConstants.TAG, "Invalid ad type for dialog ad." + this.adtype);
                }
                dialog.dismiss();
                this.activity.finish();
            }
        } catch (ActivityNotFoundException e42) {
            Log.e(IConstants.TAG, "Error whlie displaying dialog ad......: " + e42.getMessage());
        } catch (Exception e322) {
            e322.printStackTrace();
        } catch (Throwable th) {
            try {
                dialog.dismiss();
                this.activity.finish();
            } catch (Exception e7) {
            }
        }
    }

    public static AlertDialog getDialog() {
        return dialog;
    }
}
