package com.ixaexvsbscmhkbbddjlq;

import android.content.Context;
import android.media.AudioManager;
import android.media.MediaPlayer;
import android.media.MediaPlayer.OnCompletionListener;
import android.media.MediaPlayer.OnErrorListener;
import android.media.MediaPlayer.OnPreparedListener;
import android.net.Uri;
import android.util.Log;
import android.view.View;
import android.view.ViewGroup;
import android.view.ViewGroup.LayoutParams;
import android.widget.MediaController;
import android.widget.RelativeLayout;
import android.widget.TextView;
import android.widget.VideoView;
import com.ixaexvsbscmhkbbddjlq.AdController.PlayerProperties;

public class AdPlayer extends VideoView implements OnCompletionListener, OnErrorListener, OnPreparedListener {
    private static String f102g = "Loading. Please Wait..";
    private static String f103h = "AdOrmma Player";
    private PlayerProperties f104a;
    private AudioManager f105b = ((AudioManager) getContext().getSystemService("audio"));
    private AdPlayerListener f106c;
    private int f107d;
    private String f108e;
    private RelativeLayout f109f;
    private boolean f110i;

    public AdPlayer(Context context) {
        super(context);
        Log.d(f103h, "Initialized!!!");
    }

    private void m119a() {
        Log.d(f103h, "Content URL - " + this.f108e);
        this.f108e = this.f108e.trim();
        this.f108e = AdUtils.convert(this.f108e);
        if (this.f108e != null || this.f106c == null) {
            setVideoURI(Uri.parse(this.f108e));
            if (this.f104a.showControl()) {
                MediaController mediaController = new MediaController(getContext());
                setMediaController(mediaController);
                mediaController.setAnchorView(this);
            }
            setOnCompletionListener(this);
            setOnErrorListener(this);
            setOnPreparedListener(this);
            if (!(this.f104a.inline || this.f104a.inline)) {
                this.f109f = new RelativeLayout(getContext());
                this.f109f.setLayoutParams(getLayoutParams());
                View textView = new TextView(getContext());
                textView.setText(f102g);
                textView.setTextColor(-1);
                LayoutParams layoutParams = new RelativeLayout.LayoutParams(-2, -2);
                layoutParams.addRule(13);
                this.f109f.addView(textView, layoutParams);
                ((ViewGroup) getParent()).addView(this.f109f);
            }
            if (this.f104a.isAutoPlay()) {
                start();
                return;
            }
            return;
        }
        m120b();
        this.f106c.onError();
    }

    private void m120b() {
        ViewGroup viewGroup = (ViewGroup) getParent();
        if (viewGroup != null) {
            viewGroup.removeView(this);
        }
    }

    private void m121c() {
        if (this.f109f != null) {
            ((ViewGroup) getParent()).removeView(this.f109f);
        }
    }

    public void onCompletion(MediaPlayer mediaPlayer) {
        if (this.f104a.doLoop()) {
            start();
        } else if (this.f104a.exitOnComplete() || this.f104a.inline) {
            releasePlayer();
        }
    }

    public boolean onError(MediaPlayer mediaPlayer, int i, int i2) {
        Log.i(f103h, "Player error : " + i);
        m121c();
        m120b();
        if (this.f106c != null) {
            this.f106c.onError();
        }
        return false;
    }

    public void onPrepared(MediaPlayer mediaPlayer) {
        m121c();
        if (this.f106c != null) {
            this.f106c.onPrepared();
        }
    }

    public void playAudio() {
        m119a();
    }

    public void playVideo() {
        if (this.f104a.doMute()) {
            this.f107d = this.f105b.getStreamVolume(3);
            this.f105b.setStreamVolume(3, 0, 4);
        }
        m119a();
    }

    public void releasePlayer() {
        if (!this.f110i) {
            this.f110i = true;
            stopPlayback();
            m120b();
            if (this.f104a != null && this.f104a.doMute()) {
                this.f105b.setStreamVolume(3, this.f107d, 4);
            }
            if (this.f106c != null) {
                this.f106c.onComplete();
            }
        }
    }

    public void setListener(AdPlayerListener adPlayerListener) {
        this.f106c = adPlayerListener;
    }

    public void setPlayData(PlayerProperties playerProperties, String str) {
        this.f110i = false;
        this.f104a = playerProperties;
        this.f108e = str;
        Log.d(f103h, "Setting data - " + this.f108e);
    }
}
