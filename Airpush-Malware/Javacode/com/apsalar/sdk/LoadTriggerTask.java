package com.apsalar.sdk;

import android.content.Context;
import android.content.Intent;
import android.os.AsyncTask;

/* compiled from: ApLoader */
class LoadTriggerTask extends AsyncTask<String, Void, String[]> {
    private Context context = null;
    private ApsalarSessionInfo info = null;
    private Boolean ready = null;
    private String triggerName = null;

    public LoadTriggerTask(ApsalarSessionInfo apsalarSessionInfo, Context context) {
        this.info = apsalarSessionInfo;
        this.context = context;
    }

    protected String[] doInBackground(String... strArr) {
        if (this.info == null || strArr.length <= 0 || Apsalar.triggerActive.booleanValue()) {
            return null;
        }
        ApsalarTrigger apsalarTrigger;
        Apsalar.triggerActive = Boolean.valueOf(true);
        if (strArr.length == 1) {
            apsalarTrigger = new ApsalarTrigger(strArr[0], this.info);
        } else {
            apsalarTrigger = new ApsalarTrigger(strArr[0], strArr[1], this.info);
        }
        if (apsalarTrigger.REST(Boolean.valueOf(false)) == 1) {
            this.triggerName = strArr[0];
            return new String[]{String.valueOf(r2), apsalarTrigger.returnData};
        }
        return new String[]{String.valueOf(apsalarTrigger.REST(Boolean.valueOf(false))), null};
    }

    protected void onPostExecute(String[] strArr) {
        if (strArr == null || strArr.length != 2) {
            Apsalar.triggerActive = Boolean.valueOf(false);
            return;
        }
        int parseInt = Integer.parseInt(strArr[0]);
        String str = strArr[1];
        if (parseInt != 1) {
            Apsalar.triggerActive = Boolean.valueOf(false);
        } else if (str.startsWith("callback:")) {
            if (this.info != null) {
                CallbackURL callbackURL = new CallbackURL(str);
                if (Apsalar.registered_callbacks.containsKey(callbackURL.signature)) {
                    Apsalar.eventJSON("__click__", callbackURL.clickParams);
                    ((ApCallback) ((ApsalarItem) Apsalar.registered_callbacks.get(callbackURL.signature)).val).executeCallback(callbackURL.argValsJSON);
                }
            }
            Apsalar.triggerActive = Boolean.valueOf(false);
        } else if (this.info != null) {
            Intent intent = new Intent(this.context, Activity.class);
            intent.putExtra("op", "ad");
            intent.putExtra("content", str);
            this.context.startActivity(intent);
        }
        if (this.triggerName != null) {
            Apsalar.executed_triggers.add(this.triggerName);
        }
    }
}
