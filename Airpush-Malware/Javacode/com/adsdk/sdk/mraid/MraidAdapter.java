package com.adsdk.sdk.mraid;

import android.widget.FrameLayout.LayoutParams;
import com.adsdk.sdk.mraid.MraidView.OnCloseListener;
import com.adsdk.sdk.mraid.MraidView.OnExpandListener;
import com.adsdk.sdk.mraid.MraidView.OnFailureListener;
import com.adsdk.sdk.mraid.MraidView.OnReadyListener;
import com.adsdk.sdk.mraid.MraidView.ViewState;

public class MraidAdapter extends BaseAdapter {
    private MraidView mMraidView;
    private boolean mPreviousAutorefreshSetting;

    class C01911 implements OnReadyListener {
        C01911() {
        }

        public void onReady(MraidView view) {
            if (!MraidAdapter.this.isInvalidated()) {
                MraidAdapter.this.mMoPubView.nativeAdLoaded();
            }
        }
    }

    class C01922 implements OnExpandListener {
        C01922() {
        }

        public void onExpand(MraidView view) {
            if (!MraidAdapter.this.isInvalidated()) {
                MraidAdapter.this.mPreviousAutorefreshSetting = MraidAdapter.this.mMoPubView.getAutorefreshEnabled();
                MraidAdapter.this.mMoPubView.setAutorefreshEnabled(false);
                MraidAdapter.this.mMoPubView.adPresentedOverlay();
                MraidAdapter.this.mMoPubView.registerClick();
            }
        }
    }

    class C01933 implements OnCloseListener {
        C01933() {
        }

        public void onClose(MraidView view, ViewState newViewState) {
            if (!MraidAdapter.this.isInvalidated()) {
                MraidAdapter.this.mMoPubView.setAutorefreshEnabled(MraidAdapter.this.mPreviousAutorefreshSetting);
                MraidAdapter.this.mMoPubView.adClosed();
            }
        }
    }

    class C01944 implements OnFailureListener {
        C01944() {
        }

        public void onFailure(MraidView view) {
            if (!MraidAdapter.this.isInvalidated()) {
                MraidAdapter.this.mMoPubView.loadFailUrl();
            }
        }
    }

    public void init(MoPubView view, String jsonParams) {
        super.init(view, jsonParams);
        this.mPreviousAutorefreshSetting = false;
    }

    public void loadAd() {
        if (!isInvalidated()) {
            this.mMraidView = new MraidView(this.mMoPubView.getContext());
            this.mMraidView.loadHtmlData(this.mJsonParams);
            initMraidListeners();
            this.mMoPubView.removeAllViews();
            LayoutParams layoutParams = new LayoutParams(-1, -1);
            layoutParams.gravity = 17;
            this.mMoPubView.addView(this.mMraidView, layoutParams);
        }
    }

    public void invalidate() {
        this.mMoPubView = null;
        if (this.mMraidView != null) {
            this.mMraidView.destroy();
        }
        super.invalidate();
    }

    private void initMraidListeners() {
        this.mMraidView.setOnReadyListener(new C01911());
        this.mMraidView.setOnExpandListener(new C01922());
        this.mMraidView.setOnCloseListener(new C01933());
        this.mMraidView.setOnFailureListener(new C01944());
    }
}
