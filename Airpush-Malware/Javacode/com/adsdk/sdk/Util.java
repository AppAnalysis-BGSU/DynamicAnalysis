package com.adsdk.sdk;

import android.app.ActivityManager;
import android.content.Context;
import android.content.SharedPreferences;
import android.content.res.Resources;
import android.location.Location;
import android.location.LocationManager;
import android.net.ConnectivityManager;
import android.net.NetworkInfo;
import android.os.Build;
import android.os.Build.VERSION;
import android.preference.PreferenceManager;
import android.provider.Settings.Secure;
import android.telephony.TelephonyManager;
import android.view.animation.AlphaAnimation;
import android.view.animation.AnimationSet;
import android.view.animation.TranslateAnimation;
import java.math.BigInteger;
import java.net.InetAddress;
import java.net.NetworkInterface;
import java.net.SocketException;
import java.security.MessageDigest;
import java.util.Enumeration;
import java.util.Locale;
import java.util.UUID;
import sf.hellicon.android.MainActivity;

public class Util {
    private static int sFadeInAnimationId = 0;
    private static int sFadeOutAnimationId = 0;
    private static int sSlideInBottomAnimationId = 0;
    private static int sSlideInLeftAnimationId = 0;
    private static int sSlideInRightAnimationId = 0;
    private static int sSlideInTopAnimationId = 0;
    private static int sSlideOutBottomAnimationId = 0;
    private static int sSlideOutLeftAnimationId = 0;
    private static int sSlideOutRightAnimationId = 0;
    private static int sSlideOutTopAnimationId = 0;

    public static boolean isNetworkAvailable(Context ctx) {
        if (ctx.checkCallingOrSelfPermission("android.permission.ACCESS_NETWORK_STATE") != 0) {
            return true;
        }
        NetworkInfo info = ((ConnectivityManager) ctx.getSystemService("connectivity")).getActiveNetworkInfo();
        if (info == null) {
            return false;
        }
        int netType = info.getType();
        if (netType == 1 || netType == 0) {
            return info.isConnected();
        }
        return false;
    }

    public static String getConnectionType(Context context) {
        if (context.checkCallingOrSelfPermission("android.permission.ACCESS_NETWORK_STATE") != 0) {
            return Const.CONNECTION_TYPE_UNKNOWN;
        }
        NetworkInfo info = ((ConnectivityManager) context.getSystemService("connectivity")).getActiveNetworkInfo();
        if (info == null) {
            return Const.CONNECTION_TYPE_UNKNOWN;
        }
        int netType = info.getType();
        int netSubtype = info.getSubtype();
        if (netType == 1) {
            return Const.CONNECTION_TYPE_WIFI;
        }
        if (netType == 6) {
            return Const.CONNECTION_TYPE_WIMAX;
        }
        if (netType != 0) {
            return Const.CONNECTION_TYPE_UNKNOWN;
        }
        switch (netSubtype) {
            case 1:
                return Const.CONNECTION_TYPE_MOBILE_GPRS;
            case 2:
                return Const.CONNECTION_TYPE_MOBILE_EDGE;
            case 3:
                return Const.CONNECTION_TYPE_MOBILE_UMTS;
            case 4:
                return Const.CONNECTION_TYPE_MOBILE_CDMA;
            case 5:
                return Const.CONNECTION_TYPE_MOBILE_EVDO_0;
            case 6:
                return Const.CONNECTION_TYPE_MOBILE_EVDO_A;
            case 7:
                return Const.CONNECTION_TYPE_MOBILE_1xRTT;
            case 8:
                return Const.CONNECTION_TYPE_MOBILE_HSDPA;
            case 9:
                return Const.CONNECTION_TYPE_MOBILE_HSUPA;
            case 10:
                return Const.CONNECTION_TYPE_MOBILE_HSPA;
            case 11:
                return Const.CONNECTION_TYPE_MOBILE_IDEN;
            case MainActivity.MENU_TOP_APPS /*12*/:
                return Const.CONNECTION_TYPE_MOBILE_EVDO_B;
            case MainActivity.MENU_RANDOM_LEVELS_ON /*13*/:
                return Const.CONNECTION_TYPE_MOBILE_LTE;
            case MainActivity.MENU_RANDOM_LEVELS_OFF /*14*/:
                return Const.CONNECTION_TYPE_MOBILE_EHRPD;
            case 15:
                return Const.CONNECTION_TYPE_MOBILE_HSPAP;
            default:
                return Const.CONNECTION_TYPE_MOBILE_UNKNOWN;
        }
    }

    public static String getLocalIpAddress() {
        try {
            Enumeration<NetworkInterface> en = NetworkInterface.getNetworkInterfaces();
            while (en.hasMoreElements()) {
                Enumeration<InetAddress> enumIpAddr = ((NetworkInterface) en.nextElement()).getInetAddresses();
                while (enumIpAddr.hasMoreElements()) {
                    InetAddress inetAddress = (InetAddress) enumIpAddr.nextElement();
                    if (!inetAddress.isLoopbackAddress()) {
                        return inetAddress.getHostAddress().toString();
                    }
                }
            }
        } catch (SocketException ex) {
            Log.m4e(ex.toString());
        }
        return null;
    }

    public static String getTelephonyDeviceId(Context context) {
        if (context.checkCallingOrSelfPermission("android.permission.READ_PHONE_STATE") == 0) {
            return ((TelephonyManager) context.getSystemService("phone")).getDeviceId();
        }
        return "";
    }

    public static String getDeviceId(Context context) {
        String androidId = Secure.getString(context.getContentResolver(), IConstants.ANDROID_ID);
        if (androidId == null || androidId.equals("9774d56d682e549c") || androidId.equals("0000000000000000")) {
            SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(context);
            androidId = prefs.getString(Const.PREFS_DEVICE_ID, null);
            if (androidId == null) {
                try {
                    String uuid = UUID.randomUUID().toString();
                    MessageDigest.getInstance("MD5").update(uuid.getBytes(), 0, uuid.length());
                    androidId = String.format("%032X", new Object[]{new BigInteger(1, digest.digest())}).substring(0, 16);
                } catch (Throwable e) {
                    Log.m3d("Could not generate pseudo unique id", e);
                    androidId = "9774d56d682e549c";
                }
                prefs.edit().putString(Const.PREFS_DEVICE_ID, androidId).commit();
            }
            Log.m0d("Unknown Android ID using pseudo unique id:" + androidId);
        }
        return androidId;
    }

    public static Location getLocation(Context context) {
        int isAccessFineLocation = context.checkCallingOrSelfPermission("android.permission.ACCESS_FINE_LOCATION");
        int isAccessCoarseLocation = context.checkCallingOrSelfPermission("android.permission.ACCESS_COARSE_LOCATION");
        if (isAccessFineLocation == 0 || isAccessCoarseLocation == 0) {
            LocationManager locationManager = (LocationManager) context.getSystemService("location");
            if (locationManager != null) {
                if (isAccessFineLocation == 0 && locationManager.isProviderEnabled("gps")) {
                    return locationManager.getLastKnownLocation("gps");
                }
                if (isAccessCoarseLocation == 0 && locationManager.isProviderEnabled("network")) {
                    return locationManager.getLastKnownLocation("network");
                }
            }
        }
        return null;
    }

    public static String getDefaultUserAgentString(Context context) {
        return System.getProperty("http.agent");
    }

    public static String buildUserAgent() {
        String androidVersion = VERSION.RELEASE;
        String model = Build.MODEL;
        String androidBuild = Build.ID;
        Locale l = Locale.getDefault();
        String language = l.getLanguage();
        String locale = "en";
        if (language != null) {
            locale = language.toLowerCase();
            String country = l.getCountry();
            if (country != null) {
                locale = new StringBuilder(String.valueOf(locale)).append("-").append(country.toLowerCase()).toString();
            }
        }
        return String.format(Const.USER_AGENT_PATTERN, new Object[]{androidVersion, locale, model, androidBuild});
    }

    public static int getMemoryClass(Context context) {
        try {
            return ((Integer) ActivityManager.class.getMethod("getMemoryClass", new Class[0]).invoke((ActivityManager) context.getSystemService("activity"), new Object[0])).intValue();
        } catch (Exception e) {
            return 16;
        }
    }

    public static void initializeAnimations(Context ctx) {
        Resources r = ctx.getResources();
        sFadeInAnimationId = r.getIdentifier("fade_in", "anim", ctx.getPackageName());
        sFadeOutAnimationId = r.getIdentifier("fade_out", "anim", ctx.getPackageName());
        sSlideInBottomAnimationId = r.getIdentifier("slide_bottom_in", "anim", ctx.getPackageName());
        sSlideOutBottomAnimationId = r.getIdentifier("slide_bottom_out", "anim", ctx.getPackageName());
        sSlideInTopAnimationId = r.getIdentifier("slide_top_in", "anim", ctx.getPackageName());
        sSlideOutTopAnimationId = r.getIdentifier("slide_top_out", "anim", ctx.getPackageName());
        sSlideInLeftAnimationId = r.getIdentifier("slide_left_in", "anim", ctx.getPackageName());
        sSlideOutLeftAnimationId = r.getIdentifier("slide_left_out", "anim", ctx.getPackageName());
        sSlideInRightAnimationId = r.getIdentifier("slide_right_in", "anim", ctx.getPackageName());
        sSlideOutRightAnimationId = r.getIdentifier("slide_right_out", "anim", ctx.getPackageName());
    }

    public static AnimationSet getEnterAnimationSet(int animation) {
        AnimationSet set = new AnimationSet(false);
        AlphaAnimation alphaAnimation = new AlphaAnimation(0.0f, 1.0f);
        alphaAnimation.setDuration(3000);
        set.addAnimation(alphaAnimation);
        TranslateAnimation translateAnimation;
        switch (animation) {
            case 1:
            case 6:
                return set;
            case 2:
                translateAnimation = new TranslateAnimation(1, 0.0f, 1, 0.0f, 1, -1.0f, 1, 0.0f);
                translateAnimation.setDuration(1000);
                set.addAnimation(translateAnimation);
                return set;
            case 3:
                translateAnimation = new TranslateAnimation(1, 0.0f, 1, 0.0f, 1, 1.0f, 1, 0.0f);
                translateAnimation.setDuration(1000);
                set.addAnimation(translateAnimation);
                return set;
            case 4:
                translateAnimation = new TranslateAnimation(1, -1.0f, 1, 0.0f, 1, 0.0f, 1, 0.0f);
                translateAnimation.setDuration(1000);
                set.addAnimation(translateAnimation);
                return set;
            case 5:
                translateAnimation = new TranslateAnimation(1, 1.0f, 1, 0.0f, 1, 0.0f, 1, 0.0f);
                translateAnimation.setDuration(1000);
                set.addAnimation(translateAnimation);
                return set;
            default:
                return null;
        }
    }

    public static AnimationSet getExitAnimationSet(int animation) {
        AnimationSet set = new AnimationSet(false);
        AlphaAnimation alphaAnimation = new AlphaAnimation(1.0f, 0.0f);
        alphaAnimation.setDuration(3000);
        set.addAnimation(alphaAnimation);
        TranslateAnimation translateAnimation;
        switch (animation) {
            case 1:
            case 6:
                return set;
            case 2:
                translateAnimation = new TranslateAnimation(1, 0.0f, 1, 0.0f, 1, 0.0f, 1, -1.0f);
                translateAnimation.setDuration(1000);
                set.addAnimation(translateAnimation);
                return set;
            case 3:
                translateAnimation = new TranslateAnimation(1, 0.0f, 1, 0.0f, 1, 0.0f, 1, 1.0f);
                translateAnimation.setDuration(1000);
                set.addAnimation(translateAnimation);
                return set;
            case 4:
                translateAnimation = new TranslateAnimation(1, 0.0f, 1, -1.0f, 1, 0.0f, 1, 0.0f);
                translateAnimation.setDuration(1000);
                set.addAnimation(translateAnimation);
                return set;
            case 5:
                translateAnimation = new TranslateAnimation(1, 0.0f, 1, 1.0f, 1, 0.0f, 1, 0.0f);
                translateAnimation.setDuration(1000);
                set.addAnimation(translateAnimation);
                return set;
            default:
                return null;
        }
    }

    public static int getEnterAnimation(int animation) {
        switch (animation) {
            case 1:
                return sFadeInAnimationId;
            case 2:
                return sSlideInTopAnimationId;
            case 3:
                return sSlideInBottomAnimationId;
            case 4:
                return sSlideInLeftAnimationId;
            case 5:
                return sSlideInRightAnimationId;
            case 6:
                return sFadeInAnimationId;
            default:
                return 0;
        }
    }

    public static int getExitAnimation(int animation) {
        switch (animation) {
            case 1:
                return sFadeOutAnimationId;
            case 2:
                return sSlideOutTopAnimationId;
            case 3:
                return sSlideOutBottomAnimationId;
            case 4:
                return sSlideOutLeftAnimationId;
            case 5:
                return sSlideOutRightAnimationId;
            case 6:
                return sFadeOutAnimationId;
            default:
                return 0;
        }
    }
}
